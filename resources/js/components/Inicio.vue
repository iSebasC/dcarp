<template>
  <div class="row">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-body">
                <h4 class="card-title">Ticket</h4> Hi There, i was wondering, do you provide a service to build custom pages. I need some pages for a ticket system similar to the one you have. Please advise if you provide this service and i will send through my requirements. Regards.
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                <h4 class="card-title">Ticket Replies</h4>
                <ul class="list-unstyled m-t-40">
                    <li class="media">
                        <img class="m-r-15" src="/images/users/2.jpg" width="60" alt="Generic placeholder image">
                        <div class="media-body">
                            <h5 class="mt-0 mb-1">User Name</h5> Cras sit amet nibh libero, in gravida nulla. Nulla vel metus scelerisque ante sollicitudin. Cras purus odio, vestibulum in vulputate at, tempus viverra turpis. Fusce condimentum nunc ac nisi vulputate fringilla. Donec lacinia congue felis in faucibus.
                        </div>
                    </li>
                    <hr>
                    <li class="media my-4">
                        <img class="m-r-15" src="/images/users/1.jpg" width="60" alt="Generic placeholder image">
                        <div class="media-body">
                            <h5 class="mt-0 mb-1">Agent Name</h5> Cras sit amet nibh libero, in gravida nulla. Nulla vel metus scelerisque ante sollicitudin. Cras purus odio, vestibulum in vulputate at, tempus viverra turpis. Fusce condimentum nunc ac nisi vulputate fringilla. Donec lacinia congue felis in faucibus.
                        </div>
                    </li>
                    <hr>
                    <li class="media">
                        <img class="m-r-15" src="/images/users/2.jpg" width="60" alt="Generic placeholder image">
                        <div class="media-body">
                            <h5 class="mt-0 mb-1">User Name</h5> Cras sit amet nibh libero, in gravida nulla. Nulla vel metus scelerisque ante sollicitudin. Cras purus odio, vestibulum in vulputate at, tempus viverra turpis. Fusce condimentum nunc ac nisi vulputate fringilla. Donec lacinia congue felis in faucibus.
                        </div>
                    </li>
                    <hr>
                    <li class="media">
                        <img class="m-r-15" src="/images/users/2.jpg" width="60" alt="Generic placeholder image">
                        <div class="media-body">
                            <h5 class="mt-0 mb-1">User Name</h5> Cras sit amet nibh libero, in gravida nulla. Nulla vel metus scelerisque ante sollicitudin. Cras purus odio, vestibulum in vulputate at, tempus viverra turpis. Fusce condimentum nunc ac nisi vulputate fringilla. Donec lacinia congue felis in faucibus.
                        </div>
                    </li>
                    <hr>
                    <li class="media my-4">
                        <img class="m-r-15" src="/images/users/1.jpg" width="60" alt="Generic placeholder image">
                        <div class="media-body">
                            <h5 class="mt-0 mb-1">Agent Name</h5> Cras sit amet nibh libero, in gravida nulla. Nulla vel metus scelerisque ante sollicitudin. Cras purus odio, vestibulum in vulputate at, tempus viverra turpis. Fusce condimentum nunc ac nisi vulputate fringilla. Donec lacinia congue felis in faucibus.
                        </div>
                    </li>
                    <hr>
                    <li class="media">
                        <img class="m-r-15" src="/images/users/2.jpg" width="60" alt="Generic placeholder image">
                        <div class="media-body">
                            <h5 class="mt-0 mb-1">User Name</h5> Cras sit amet nibh libero, in gravida nulla. Nulla vel metus scelerisque ante sollicitudin. Cras purus odio, vestibulum in vulputate at, tempus viverra turpis. Fusce condimentum nunc ac nisi vulputate fringilla. Donec lacinia congue felis in faucibus.
                        </div>
                    </li>
                </ul>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                <h4 class="m-b-20">Write a reply</h4>
                <form method="post">
                    <textarea id="mymce" name="area"></textarea>
                    <button type="button" class="m-t-20 btn waves-effect waves-light btn-success">Reply</button>
                    <button type="button" class="m-t-20 btn waves-effect waves-light btn-info">Reply & close</button>
                </form>
            </div>
        </div>
    </div>
    <!-- <div class="col-lg-4">
        <div class="card">
            <div class="card-body">
                <h4 class="card-title">Ticket Info</h4>
            </div>
            <div class="card-body bg-light">
                <div class="row text-center">
                    <div class="col-6 m-t-10 m-b-10">
                        <span class="label label-warning">In Progress</span>
                    </div>
                    <div class="col-6 m-t-10 m-b-10">
                        May 2, 2018 9:49
                    </div>
                </div>
            </div>
            <div class="card-body">
                <h5 class="p-t-20">Ticket Creator</h5>
                <span>User Name</span>
                <h5 class="m-t-30">Support Staff</h5>
                <span>Agent Name</span>
                <br/>
                <button type="button" class="m-t-20 btn waves-effect waves-light btn-success">Update</button>
            </div>
        </div>
        <div class="card">
            <div class="card-body text-center">
                <h4 class="card-title">User Info</h4>
                <div class="profile-pic m-b-20 m-t-20">
                    <img src="/images/users/5.jpg" width="150" class="rounded-circle" alt="user">
                    <h4 class="m-t-20 m-b-0">Daniel Kristeen</h4>
                    <a href="mailto:danielkristeen@gmail.com">danielkristeen@gmail.com</a>
                </div>
                <div class="row text-center m-t-40">
                    <div class="col-4">
                        <h3 class="font-bold">4</h3>
                        <h6>Total</h6></div>
                    <div class="col-4">
                        <h3 class="font-bold">2</h3>
                        <h6>Open</h6></div>
                    <div class="col-4">
                        <h3 class="font-bold">3</h3>
                        <h6>Closed</h6></div>
                </div>
            </div>
            <div class="p-25 border-top m-t-15">
                <div class="row text-center">
                    <div class="col-6 border-right">
                        <a href="#" class="link d-flex align-items-center justify-content-center font-medium"><i class="mdi mdi-message font-20 m-r-5"></i>Message</a>
                    </div>
                    <div class="col-6">
                        <a href="#" class="link d-flex align-items-center justify-content-center font-medium"><i class="mdi mdi-developer-board font-20 m-r-5"></i>Portfolio</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                <h4 class="card-title">Ticket Statestics</h4>
                <div id="visitor" style="height:290px; width:100%;" class="m-t-20"></div>
            </div>
        </div>
    </div> -->
  </div>


  <!-- eCommerce statistic -->
<!--       
  <div class="content-wrapper">
    <div class="content-header row"></div>
    <div
      class="content-body"
      v-if="usuario != null && usuario.categoriaPersonalId == 1"
    >
      <div class="row">
        <div class="col-xl-3 col-lg-6 col-12">
          <div class="card pull-up">
            <div class="card-content">
              <div class="card-body">
                <div class="media d-flex">
                  <div class="media-body text-left">
                    <h3 class="info" v-text="'S/ ' + ventas"></h3>
                    <h6>Ventas</h6>
                  </div>
                  <div>
                    <i
                      class="la la-shopping-cart info font-large-2 float-right"
                    ></i>
                  </div>
                </div>
                <div class="progress progress-sm mt-1 mb-0 box-shadow-2">
                  <div
                    class="progress-bar bg-gradient-x-info"
                    role="progressbar"
                    style="width: 80%"
                    aria-valuenow="80"
                    aria-valuemin="0"
                    aria-valuemax="100"
                  ></div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-xl-3 col-lg-6 col-12">
          <div class="card pull-up">
            <div class="card-content">
              <div class="card-body">
                <div class="media d-flex">
                  <div class="media-body text-left">
                    <h3 class="warning" v-text="productos"></h3>
                    <h6>Productos</h6>
                  </div>
                  <div>
                    <i class="la la-store warning font-large-2 float-right"></i>
                  </div>
                </div>
                <div class="progress progress-sm mt-1 mb-0 box-shadow-2">
                  <div
                    class="progress-bar bg-gradient-x-warning"
                    role="progressbar"
                    style="width: 85%"
                    aria-valuenow="65"
                    aria-valuemin="0"
                    aria-valuemax="100"
                  ></div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-xl-3 col-lg-6 col-12">
          <div class="card pull-up">
            <div class="card-content">
              <div class="card-body">
                <div class="media d-flex">
                  <div class="media-body text-left">
                    <h3 class="success" v-text="clientes"></h3>
                    <h6>Clientes</h6>
                  </div>
                  <div>
                    <i
                      class="
                        la la-user-friends
                        success
                        font-large-2
                        float-right
                      "
                    ></i>
                  </div>
                </div>
                <div class="progress progress-sm mt-1 mb-0 box-shadow-2">
                  <div
                    class="progress-bar bg-gradient-x-success"
                    role="progressbar"
                    style="width: 75%"
                    aria-valuenow="75"
                    aria-valuemin="0"
                    aria-valuemax="100"
                  ></div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-xl-3 col-lg-6 col-12">
          <div class="card pull-up">
            <div class="card-content">
              <div class="card-body">
                <div class="media d-flex">
                  <div class="media-body text-left">
                    <h3
                      class="danger"
                      v-text="
                        Math.round(((satisfaccion * 100) / clientes) * 100) /
                          100 +
                        ' %'
                      "
                    ></h3>
                    <h6>Satisfacción</h6>
                  </div>
                  <div>
                    <i class="la la-star danger font-large-2 float-right"></i>
                  </div>
                </div>
                <div class="progress progress-sm mt-1 mb-0 box-shadow-2">
                  <div
                    class="progress-bar bg-gradient-x-danger"
                    role="progressbar"
                    style="width: 85%"
                    aria-valuenow="85"
                    aria-valuemin="0"
                    aria-valuemax="100"
                  ></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row match-height">
        <div class="col-xl-8 col-12" id="ecommerceChartView">
          <div class="card card-shadow height-max">
            <div class="card-header card-header-transparent py-20">
              <div class="btn-group dropdown">
                <a href="#" class="text-body blue-grey-700">Mis Ventas</a>
              </div>
              <ul
                class="
                  nav nav-pills nav-pills-rounded
                  chart-action
                  float-right
                  btn-group
                "
                role="group"
              >
                <li class="nav-item">
                  <a
                    class="nav-link"
                    @click="cargarVentas('Mis Ventas Diarias')"
                    data-toggle="tab"
                    href="javascript:void(0);"
                    >Diarias</a
                  >
                </li>
                <li class="nav-item">
                  <a
                    class="nav-link"
                    data-toggle="tab"
                    @click="cargarVentas('Mis Ventas Por Semana')"
                    href="javascript:void(0);"
                    >Semana</a
                  >
                </li>
                <li class="nav-item">
                  <a
                    class="nav-link active"
                    @click="cargarVentas('Mis Ventas Mensuales')"
                    data-toggle="tab"
                    href="javascript:void(0);"
                    >Mes</a
                  >
                </li>
              </ul>
            </div>
            <div
              class="
                widget-content
                tab-content
                bg-white
                p-20
                pb-3
                small
                mx-auto
              "
            >
              <line-vent
                :chart-data="this.datacollection"
                :options="this.options"
              ></line-vent>
            </div>
          </div>
        </div>

        <div class="col-xl-4 col-lg-12">
          <div class="card height-max">
            <div class="card-header">
              <h4 class="card-title">Mis Productos</h4>
            </div>
            <div class="card-content small-graph mx-auto pb-3">
              <line-product />
            </div>
          </div>
        </div>
      </div>
    </div>
    <div v-if="usuario != null && usuario.categoriaPersonalId != 1">
      <div class="row">
        <section class="card mx-auto">
          <div id="invoice-template" class="card-body p-4">
            <div id="invoice-company-details" class="row">
              <div class="col-sm-6 col-12 text-center text-sm-left">
                <div class="media row">
                  <div class="col-12 col-sm-6 col-xl-6 p-0">
                    <img
                      src="/images/logo_carpio.png"
                      alt="company logo"
                      class="mb-1 mb-sm-0 w-100"
                    />
                  </div>
                  <div class="col-12 col-sm-6 col-xl-6 p-0">
                    <div class="media-body">
                      <ul class="ml-1 px-0 list-unstyled">
                        <li class="text-bold-800">CARPIO SAC</li>
                        <li>San Martín,</li>
                        <li>Tarapoto,</li>
                        <li>Perú</li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-6 col-12 text-center text-sm-right">
                <h2>TELÉFONO</h2>
                <p class="pb-sm-3">933 016 972</p>
                 </div>
            </div>

            <div id="invoice-customer-details" class="row pt-2">
               <div class="col-sm-6 col-12 text-center text-sm-left">
                <ul class="px-0 list-unstyled">
                  <li
                    class="text-bold-800"
                    v-text="usuario != null ? usuario.usuario : '-'"
                  ></li>
                  <li
                    v-text="usuario != null ? usuario.correoElectronico : '-'"
                  ></li>
                  </ul>
              </div>
              <div class="col-sm-6 col-12 text-center text-sm-right">
              </div>
            </div>
          </div>
        </section>
      </div>
    </div>
  </div> -->
</template>
<script>
import { misMixins } from "../mixins/mixin.js";
import LineVent from "./GraficoVentas";
import LineProduct from "./GraficoProductos";
import axios from "axios";

export default {
  name: "Inicio",
  mixins: [misMixins],
  components: {
    LineVent,
    LineProduct,
  },
  data() {
    return {
      datacollection: {},
      options: {},
      texto: "Mis Ventas Mensuales",
      labels: [],
      datos: [],
      clientes: 0,
      productos: 0,
      ventas: 0,
      satisfaccion: 0,
      primeraCarga: 0,
      usuario: null,
    };
  },

  methods: {
    // async
    async actualizarCotizaciones() {
      let me = this;
      let respuesta = await axios.get("/situacionCotizacion");
      // console.log(respuesta.data)
    },
    async cargarVentas(title) {
      this.texto = title;
      // this.datacollection = {}
      // this.options = {},
      let response = await axios.get("/reporteventas/" + title);
      this.labels = response.data.labels;
      this.datos = response.data.datos;

      this.datacollection = {
        labels: this.labels,
        datasets: [
          {
            label: "Ventas",
            data: this.datos,
            backgroundColor: "transparent",
            borderColor: "rgba(1, 116, 188, 0.50)",
            pointBackgroundColor: "rgba(171, 71, 188, 1)",
          },
        ],
      };

      this.options = {
        responsive: true,
        maintainAspectRatio: false,
        title: {
          display: true,
          text: this.texto,
        },
      };
    },
    async cargarData() {
      let me = this;
      let response = await axios.get("/reporteinicio");
      me.ventas = response.data.ventas;
      me.clientes = response.data.clientes;
      me.satisfaccion = response.data.satisfaccion;
      me.productos = response.data.productos;
    },
  },
  activated: async function () {
    this.isValidSession();
    this.usuario = JSON.parse(localStorage.getItem("usuario"));
    if (this.usuario != null && this.usuario.categoriaPersonalId == 1) {
      await this.cargarData();
      await this.cargarVentas(this.texto);
      await this.actualizarCotizaciones();
    }
    
    // this.animar();

    // console.log('estoy aca')
  },
  desactivated: function () {
    // this.$store.state.mostrarModal = !this.$store.state.mostrarModal
  },
  async mounted() {
    this.$route.meta.auth = localStorage.getItem("autenticado");
    // this.initPages();
    // console.log('Inicio...')
    // this.cargarData()
    // this.cargarVentas('Mis Ventas Mensuales')
  },
};
</script>
<style scoped>
/* .small {
  width: 95%;
  position: relative;
}
.small-graph {
  width: 95%;
  position: relative;
}
.height-max {
  height: 523.2px !important;
} */
</style>